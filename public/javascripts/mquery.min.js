function mq_createHeader(e,t){e.empty();var r=$("<tr>");e.append(r);for(var n=t.headers,i=0;i<n.length;i++){var s=$('<th class="sorting" tabindex="0" aria-controls="example" rowspan="1" colspan="1" style="width: 15%;"aria-label="Position: activate to sort column ascending">');s.text(n[i]),r.append(s)}}function mq_createBody(e,t){e.empty();for(var r=t.fields,n=t.rows,i=t.keys,s=0;s<n.length;s++){var a=s%2==0?"odd":"even",l=$("<tr>");l.addClass(a);for(var o=n[s],d=0;d<i.length;d++){var u=$("<td>");r[d].type&&u.addClass(r[d].type),u.text(r[d].getValue(o[i[d]])),l.append(u)}e.append(l)}}var MQuery=function(e,t){this.element=$(e),this.headerElement=$("<thead>"),this.bodyElement=$("<tbody>"),this.options=$.extend({pageSize:50},t),this.loadUrl="/s/pnp.mquery.finder.test01",this.queryUrl="/q/pnp.mquery.finder.test01",this.element.empty(),this.element.append(this.headerElement),this.element.append(this.bodyElement);var n=this;this.load=function(){var r=$.Deferred();return $.get(n.loadUrl,function(e){console.log("load data:",e),n.searcher=JSON.parse(e),n.fields=[];for(var t=0;t<n.searcher.fields.length;t++)n.fields[t]=new MQueryField(n.searcher.fields[t]);r.resolve("load view finished.")}),r.promise()},this.execute=function(){var r=$.Deferred();return $.post(n.queryUrl,function(e){var t=JSON.parse(e);console.log("result:",t),t.fields=n.fields,mq_createHeader(n.headerElement,t),mq_createBody(n.bodyElement,t),r.resolve("query finished.")}),r.promise()}};function mq_field_value_number(e,t){}function mq_field_value_string(e,t){return t}function mq_field_value_time(e,t){return new Date(t).Format("yyyy-MM-dd hh:mm:ss")}function mq_field_value_price(e,t){}function execute_mq_field_value(e,t){if(e.type)try{return new Function("field","value","return mq_field_value_"+e.type+"(field, value)")(e,t)}catch(e){console.log(e)}return t}var MQueryField=function(t){this.field=t,this.type=t.type;this.getTitle=function(){},this.getValue=function(e){return execute_mq_field_value(t,e)}};Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e};